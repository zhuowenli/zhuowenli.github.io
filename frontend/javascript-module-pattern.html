<!DOCTYPE html>
<html lang="en">
<head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Javascript 模块模式"/>




  <meta name="keywords" content="JavaScript," />





    <link rel="alternate" href="/atom.xml" title="Zhuo Wenli">




    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.0.0" />



<link rel="canonical" href="https://www.zhuowenli.com/frontend/javascript-module-pattern.html"/>


<meta name="description" content="Javascript 模块模式假设现在我们有一个小型的Js库，目的是用来增加一个数字： 123456789101112131415var jspy &#x3D; &amp;#123; count: 0, incrementCount: function()&amp;#123;  this.count++; &amp;#125;, decrementCount: function()&amp;#123;  this.count--; &amp;#1">
<meta property="og:type" content="article">
<meta property="og:title" content="Javascript 模块模式">
<meta property="og:url" content="https://www.zhuowenli.com/frontend/javascript-module-pattern.html">
<meta property="og:site_name" content="Zhuo Wenli">
<meta property="og:description" content="Javascript 模块模式假设现在我们有一个小型的Js库，目的是用来增加一个数字： 123456789101112131415var jspy &#x3D; &amp;#123; count: 0, incrementCount: function()&amp;#123;  this.count++; &amp;#125;, decrementCount: function()&amp;#123;  this.count--; &amp;#1">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2014-11-06T00:00:00.000Z">
<meta property="article:modified_time" content="2022-06-18T02:56:11.596Z">
<meta property="article:author" content="Zhuo Wenli">
<meta property="article:tag" content="JavaScript">
<meta name="twitter:card" content="summary">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0" />



<script type="text/javascript">
    var themeConfig = {
        color: 'Default',
        favicon: {
            enable: true,
            icon: '/favicon.ico',
            hide_text: '(●—●)喔哟，崩溃啦！',
            show_text: '(/≧▽≦/)咦！又好了！',
        }
    };
</script>



    <script id="baidu_analytics">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?7278e0ce3cabf14a3798ac2126b733d9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-171827500-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-171827500-1');
</script>


    <title> Javascript 模块模式 - Zhuo Wenli </title>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Zhuo Wenli" type="application/atom+xml">
</head>
<body>
    <div id="page">
        <header id="masthead">
<h1 class="site-title">
    <a href="/." class="logo">Zhuo Wenli</a>
</h1>


        </header>

        <div id="content">
            
    
<article class="post">
    <header class="post-header">
        <h1 class="post-title">Javascript 模块模式</h1>
        <time class="post-time">
            Nov 06 2014
        </time>
    </header>

    <div class="post-content">
        <h2 id="Javascript-模块模式"><a href="#Javascript-模块模式" class="headerlink" title="Javascript 模块模式"></a>Javascript 模块模式</h2><p>假设现在我们有一个小型的Js库，目的是用来增加一个数字：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jspy = &#123;</span><br><span class="line"> count: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"> incrementCount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.count++;</span><br><span class="line"> &#125;,</span><br><span class="line"></span><br><span class="line"> decrementCount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.count--;</span><br><span class="line"> &#125;,</span><br><span class="line"></span><br><span class="line"> getCount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.count;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>但是，使用这个js库的人可以用 <code>jspy.count = 5</code> 的方法来改变这个值。并不是我们的最初目的。在其他的编程语言中你可以定义一个私有变量，但是Javascript并不能“真正”定义私有变量。然而，我们可以通过操作Javascript来实现，这就引出了一个最流行的Javascript设计模式，<strong>模块模式</strong>。</p>
<p>针对上面问题的解决方案如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jspy = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">var</span> _count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> incrementCount = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  _count++;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> getCount = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> _count;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> &#123;</span><br><span class="line">  incrementCount : incrementCount,</span><br><span class="line">  getCount : getCount</span><br><span class="line"> &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>首先我们创造一个 <code>_count</code> 变量，下划线表明它是一个私有变量。再Javascript中下划线并没有什么实际的意义，但是它是一个用来标明私有变量的普遍用法。现在函数就可以操纵、返回变量了：<br>然而，你注意到了我吧整个库包含在了一个自调用匿名函数中。这是一个在执行过程中马上被执行的函数。这个函数运行，定义了函数和变量然后到了 <code>return {}</code> 的部分，它告诉函数将其返回给变量 <code>jspy</code> ，或者换句话说，暴露给用户。我们暴露两个函数而不是 <code>_count</code> 变量，这意味着我们可以做如下操作：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jspy.incrementCount();</span><br><span class="line">jspy.getCount();</span><br></pre></td></tr></table></figure>

<p>但是当我们试图进行如下操作时：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jspy._count; <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<p>它返回undefined。<br>对于上面的这种设计模式有许多不同的实现方法。有人喜欢在return 中定义函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jspy = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">var_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> &#123;</span><br><span class="line">  incrementCount : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   _count++;</span><br><span class="line">  &#125;,</span><br><span class="line">  getCount : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">return_count;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>受到上面例子的启发，CHristian Heilmann提出了Revealing Module Pattern。他的方法是将所有方法定义为私有变量，也就是说，不在return中定义，但是在那里暴露给用户，如下所示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jspy = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">var</span> _count = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">var</span> incrementCount = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  _count++;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">var</span> resetCount = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  _count = <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">var</span> getCount = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> _count;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> &#123;</span><br><span class="line">  add : incrementCount,</span><br><span class="line">  reset : incrementCount,</span><br><span class="line">  <span class="keyword">get</span> : getCount</span><br><span class="line"> &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>这种设计模式有两个好处：</p>
<ul>
<li>首先，它使我们更容易的了解暴露的函数。当你不在 <code>return</code> 中定义函数时，我们能轻松的了解到每一行就是一个暴露的函数，这时我们阅读代码更加轻松。</li>
<li>其次，你可以用简短的名字（例如 <code>add</code> ）来暴露函数，但在定义的时候仍然可以使用冗余的定义方法（例如 <code>incrementCount</code> ）。</li>
</ul>
<hr>
<p>原文：《<a href="http://javascriptplayground.com/blog/2012/04/javascript-module-pattern/" target="_blank" rel="noopener">The JavaScript Module Pattern</a>》<br>译者：<a href="https://zhuowenli.github.io" target="_blank" rel="noopener">卓文理</a></p>

    </div>

    <footer class="post-footer">
        
        <div class="post-tags">
            
            <a href="/tags/JavaScript/">JavaScript</a>
            
        </div>
        

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/diary/hello-github.html">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Hello GitHub!</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/frontend/background-clip.html">
        <span class="next-text nav-default">使用background-clip实现透明边框</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>


        
            
    <div class="comments" id="comments">
        
            <div id="gitalk-container"></div>
        
    </div>


        
    </footer>
</article>


        </div>

        <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2016 -
    
    2022
    <span class="footer-author">Zhuo Wenli.</span>
    <span class="power-by">Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>.</span>
    <span class="design-by">Designed by <a href="https://www.zhuowenli.com/">zhuowenli</a></span>
</span>

<nav id="nav-bottom">
    
        <ul id="menu-bottom" class="nav-bottom-items">
            
                <li class="menu-item">
                    <a href="/">
                        
                        
                            Home
                        
                    </a>
                </li>
            
                <li class="menu-item">
                    <a href="/archives">
                        
                        
                            Archives
                        
                    </a>
                </li>
            
                <li class="menu-item">
                    <a href="/about">
                        
                        
                            About
                        
                    </a>
                </li>
            
        </ul>
    
</nav>

        </footer>

        <div class="back-to-top" id="back-to-top">
            <i class="iconfont icon-up"></i>
        </div>
    </div>
    
    


<script src="/lib/gitalk.min.js"></script>
<script type="text/javascript">
    const gitalk = new Gitalk({
        clientID: '3a683f311ce3460b686d',
        clientSecret: '264685b8506d937c73b468584847c3b2347bdcfe',
        repo: 'zhuowenli.github.io',
        owner: 'zhuowenli',
        admin: 'zhuowenli'.split(','),
        pagerDirection: 'first',
        id: `Javascript 模块模式`,
        number: 36,
        distractionFreeMode: true
    });
    if (document.querySelector('#gitalk-container')) {
        gitalk.render('gitalk-container');
    }
</script>



    
    


  
    <script type="text/javascript" src="/lib/jquery-3.1.1.min.js"></script>
  


    <script type="text/javascript" src="/js/theme.js?v=1.0.0"></script>
<script type="text/javascript" src="/js/bootstrap.js?v=1.0.0"></script>

</body>
</html>
